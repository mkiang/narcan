<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Helper functions for working with multiple cause of death data • narcan</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">narcan</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/mkiang/narcan">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="contents col-md-9">
    <div id="narcan" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#narcan" class="anchor"></a><code>narcan</code>
</h1></div>

<p>An R package for working with <a href="https://wonder.cdc.gov/mcd.html">multiple cause of death micro-data</a>.</p>
<div id="warning" class="section level2">
<h2 class="hasAnchor">
<a href="#warning" class="anchor"></a>Warning</h2>
<p><strong>This package is still in the alpha stage.</strong></p>
<p>We cannot emphasize this enough. Nothing is guaranteed to work. <a href="https://github.com/mkiang/narcan/issues">Please submit an issue</a> if you find a bug.</p>
</div>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>Certain types of deaths, including drug overdoses or opioid-related deaths, are defined by an <a href="http://www.who.int/classifications/icd/en/">ICD code</a> in both the underlying cause field and one of the twenty possible contributory cause fields. Therefore, in order to tabulate these deaths, researches cannot use <a href="https://www.cdc.gov/nchs/data_access/cmf.htm">compressed mortality files (CMF)</a> (which contain only underlying cause of death), but rather must use <a href="https://wonder.cdc.gov/mcd.html">multiple cause of death (MCOD)</a> data.</p>
<p>This simple package aims to make common operations — such as downloading, munging, and cleaning — on (inherently messy) MCOD data easier.</p>
<p>Additionally, this package includes data necessary for calculating rates. Specifically, standard populations and annual US population counts from 1979 to 2015. Note that if you are only using 1990 to current, the <a href="https://www.cdc.gov/nchs/nvss/bridged_race.htm">NVSS Bridged Race</a> files are preferred.</p>
<p>This package is largely the result of our internal code getting reused for multiple papers — therefore, the scope and usefulness of the code is likely limited. We’re releasing it publicly in the hopes that other researchers will learn from our mistakes.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>This package is not available on CRAN. Use <code>devtools</code> to install:</p>
<pre><code><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github"># install.packages("devtools")
devtools::install_github("mkiang/narcan")</a></code></pre>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p>Ten lines of code to load packages, download the <code>csv</code> file, load it, and calculate the number of US residents who died from opioids, by sex, in 2015.</p>
<pre><code>library(tidyverse)
library(narcan)

download_mcod_csv(2015, "./temp_data")
mcod_2015 &lt;- read_csv("./temp_data/mort2015.csv.zip")

mcod_2015 %&gt;% 
    subset_residents() %&gt;% 
    unite_records() %&gt;% 
    flag_opioid_deaths() %&gt;% 
    group_by(sex) %&gt;% 
    summarize(deaths_involving_opioids = sum(opioid_death))

# # A tibble: 2 x 2
#     sex deaths_involving_opioids
#   &lt;chr&gt;                    &lt;dbl&gt;
# 1     F                    11420
# 2     M                    21671</code></pre>
<p>More examples soon.</p>
<div id="accessing-population-data" class="section level3">
<h3 class="hasAnchor">
<a href="#accessing-population-data" class="anchor"></a>Accessing Population Data</h3>
<p>Standard populations are held in the <code>std_pops</code> dataframe while annual population estimates (by race, sex, and age) from 1979 to 2015 are held in the <code>pop_est</code> dataframe.</p>
<pre><code>library(narcan)
population_estimates &lt;- narcan::pop_est
standard_populations &lt;- narcan::std_pops</code></pre>
</div>
<div id="more-information" class="section level3">
<h3 class="hasAnchor">
<a href="#more-information" class="anchor"></a>More information</h3>
<p>There are also several wiki examples on how to use <code>narcan</code></p>
<ul>
<li>
<a href="https://github.com/mkiang/narcan/wiki/ICD-9-download-to-clean-example-(dta)">ICD-9 / dta</a>: Download, select, filter, and clean the ICD-9 data in <code>dta</code> format.</li>
<li>
<strong>TODO</strong> Make one for ICD 10 csv</li>
<li>
<strong>TODO</strong> Make one using two years with two separate race variables</li>
<li>
<strong>TODO</strong> Make one showing <code>rnifla_</code> and <code>rniflag</code>
</li>
</ul>
</div>
</div>
<div id="irregularlities-in-mcod-data" class="section level2">
<h2 class="hasAnchor">
<a href="#irregularlities-in-mcod-data" class="anchor"></a>Irregularlities in MCOD Data</h2>
<p>It is worth noting that there are several important irregularities in the data. This package addresses some while others are simply the way the data are.</p>
<ul>
<li>From 1979 to 1998, data are coded using the ICD-9 classification.</li>
<li>From 1999 to 2015, data are coded using the ICD-10 classification.</li>
<li>For years using the ICD-9 classification, the <code>rnifla_</code> column indicates a nature of injury flag for the corresponding <code>record_</code> column. A <code>1</code> indicates an <code>N</code> code (nature of injury) while a <code>0</code> represents all other codes (e.g., <code>E</code> for external causes or <code>V</code> coeds).</li>
<li>Some years call the nature of injury flag column <code>rnifla_</code> while others call it <code>rniflag_</code>.</li>
<li>Early year <code>ascii</code> and <code>csv</code> files from NBER contain encoding errors. We suggest downloading files as <code>dta</code> for ICD-9 years and <code>csv</code> files for ICD-10 years.</li>
<li>Hispanic origin is not recorded until 1989.</li>
<li>Race codes changed across years.</li>
<li>Some years code sex as <code>M</code>/<code>F</code> and others as <code>1</code>/<code>0</code> or <code>1</code>/<code>2</code> .</li>
<li>In the restricted files, the documentation suggests state variables are coded as FIPS; however, they are actually coded as state abbreviations.</li>
</ul>
</div>
<div id="sources" class="section level2">
<h2 class="hasAnchor">
<a href="#sources" class="anchor"></a>Sources</h2>
<div id="multiple-cause-of-death" class="section level3">
<h3 class="hasAnchor">
<a href="#multiple-cause-of-death" class="anchor"></a>Multiple Cause of Death</h3>
<p>Multiple cause of death data (in multiple formats), documentation, dictionaries, and other information are stored on the <a href="http://www.nber.org/data/vital-statistics-mortality-data-multiple-cause-of-death.html">National Bureau of Economic Research (NBER) website</a>.</p>
<p>The data itself come from the <a href="https://www.cdc.gov/nchs/nvss/mortality_methods.htm">National Center for Health Statistics</a> and are subject to <a href="https://www.cdc.gov/nchs/data_access/restrictions.htm">their data use agreement</a>. A GUI interface for these data are provided by <a href="https://wonder.cdc.gov/">CDC Wonder</a></p>
</div>
<div id="standard-populations" class="section level3">
<h3 class="hasAnchor">
<a href="#standard-populations" class="anchor"></a>Standard Populations</h3>
<p>Standard populations are stored on the <a href="https://seer.cancer.gov/stdpopulations/">Surveillance, Epidemiology, and End Results (SEER)</a> section of the National Cancer Institute website.</p>
</div>
<div id="population-estimates" class="section level3">
<h3 class="hasAnchor">
<a href="#population-estimates" class="anchor"></a>Population Estimates</h3>
<p>THe annual US population estimates come from the United States Census Bureau’s <a href="https://www.census.gov/programs-surveys/popest.html">Population Estimates Program (PEP)</a>.</p>
</div>
</div>
<div id="papers-using-narcan" class="section level2">
<h2 class="hasAnchor">
<a href="#papers-using-narcan" class="anchor"></a>Papers using <code>narcan</code>
</h2>
<ul>
<li>
<strong>TODO</strong> Forthcoming <a href="https://github.com/mkiang/opioid_trends"><code>opioid_trends</code></a> paper.</li>
<li>
<strong>TODO</strong> Put <code>opioid_intent</code> paper here when submitted.</li>
<li>
<strong>TODO</strong> Forthcoming <a href="https://github.com/mkiang/opioid_spatial"><code>opioid_spatial</code></a> paper.</li>
<li>
<strong>TODO</strong> Potentially <code>opioid_age</code>.</li>
</ul>
</div>
<div id="authors" class="section level2">
<h2 class="hasAnchor">
<a href="#authors" class="anchor"></a>Authors</h2>
<p><a href="https://mathewkiang.com">Mathew Kiang</a> (<a href="https://github.com/mkiang"><code>mkiang</code></a>) and <a href="http://monicaalexander.com/">Monica Alexander</a> (<a href="https://github.com/mjalexander"><code>MJAlexander</code></a>)</p>
</div>
</div>
  </div>

  <div class="col-md-3" id="sidebar">
    <h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="http://github.com/mkiang/narcan">http://​github.com/​mkiang/​narcan</a>
</li>
<li>Report a bug at <br><a href="http://github.com/mkiang/narcan/issues">http://​github.com/​mkiang/​narcan/​issues</a>
</li>
</ul>
<h2>License</h2>
<p><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE.html">LICENSE</a></p>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Mathew Kiang <br><small class="roles"> Author, maintainer </small> </li>
<li>Monica Alexander <br><small class="roles"> Author </small> </li>
</ul>
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/mkiang/narcan"><img src="https://travis-ci.org/mkiang/narcan.svg?branch=master" alt="Build Status"></a></li>
</ul>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Mathew Kiang, Monica Alexander.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
